{% extends 'base.html' %}
{% load filters %}
{% load static %}

{% block css %}
<link rel="stylesheet" type="text/css" href="{% static 'css/user.css' %}">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block main %}
<div class="card m-5 p-3">
    <div class="row">
        <div class="col-3"></div>
        <h1 class="card-title mt-2 text-center col-6">Summary Report By Daily</h1>
        <div class="col-3">
            <label for="form-select">Choose a date:</label>
            <select class="form-select" onchange="filterByDate(this.value)">
                {% for date in dates %}
                <option value="{{ date }}">{{ date }}</option>
                {% endfor %}
            </select>
        </div>
    </div>
    <div class="card-body">
        <table id="driver_summary" class="table table-bordered">
            <thead class="table-active">
                <tr>
                    <th scope="col">Driver ID</th>
                    <th scope="col">Car Plate Value</th>
                    <th scope="col">Date</th>
                    <th scope="col">Average Speed</th>
                    <th scope="col">Total Times of Overspeed</th>
                    <th scope="col">Total Duration of Overspeed </th>
                    <th scope="col">Total Times of Fatigue Driving</th>
                    <th scope="col">Total Times of Neutral Slide</th>
                    <th scope="col">Total Duration of Neutral Slide</th>
                </tr>
            </thead>
            <tbody>
                {% for row in summaryday %}
                <tr>
                    {% for c in row %}
                        <td scope="col">{{ c|rounded }}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<script>
    var currentdate = "Jan. 1, 2017";

    function filterByDate(date) {
        currentdate = date;
        applyFilters();
    }

    function applyFilters() {
        var table, tr, i, dateTd;
        table = document.getElementById('driver_summary');
        tr = table.getElementsByTagName('tr');

        for (i = 1; i < tr.length; i++) {
            dateTd = tr[i].getElementsByTagName('td')[2];
            if (dateTd) {
                if (dateTd.innerText === currentdate) {
                    tr[i].style.display = '';
                } else {
                    tr[i].style.display = 'none';
                }
            }
        }
    }
    filterByDate(currentdate)
</script>
{% endblock %}